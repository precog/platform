server {
  port = 30070
  sslPort = 30071
  sslEnable = false

  log {
    level = "info"
    console = true
    filename = "/var/log/precog/shard-v1.server.log"
    roll = "daily"
    use_parents = false
  }
}

zookeeper {
  port = "2181"
  dataDir = "/var/zookeeper"
}

kafka {
  local {
    port = "9082"
    log.dir = "/var/kafka/local"
  }
  central {
    port = "9092"
    log.dir = "/var/kafka/central"
  }
}

services {
  quirrel {
    v1 {
      log {
        level = "debug"
        console = true
        filename = "/var/log/precog/shard-v1.log"
        roll = "daily"
        use_parents = false
      }

      requestLog {
        enabled = false
        file = "/var/log/precog/shard-v1.request.log"
        roll = "daily"
        fields = "date time c-ip cs-method cs-uri-stem cs-uri-query sc-status cs-content"
        formatter = "w3cs"
        excludePaths = ["/blueeyes/services/quirrel/v1/health"]
      }

      labcoat {
        port = 8000
      }

      queryExecutor {
        systemId = desktop
        precog {
          storage {
            root = /opt/precog/shard/
          }
          kafka {
            enabled = true
            topic {
              events = central_event_store
            }
            consumer {
              zk {
                connect = localhost:2181
                connectiontimeout {
                  ms = 1000000
                }
              }
              groupid = shard_consumer
            }
          }
        }
        ingest {
          enabled = true
          failure_log_root = /opt/precog/shard/ingest_failures
        }
        kafka {
          batch {
            host = localhost
            port = 9092
            topic = central_event_store
          }
        }
        zookeeper {
          hosts = localhost:2181
        }
      }

      security {
        masterAccount {
          apiKey = "12345678-1234-1234-1234-123456789abc"
          accountId = "desktop"
        }
      }

      accounts {
        service {
          static_account = "desktop"
        }
      }

      jobs {
      }

      eventStore {
        systemId = "desktop"
        local {
          topic = "local_event_cache"
          broker {
            host = "localhost"
            port = 9082
          }
          serializer.class = "com.precog.common.kafka.KafkaIngestMessageCodec"
        }
        central {
          topic = "central_event_store"
          broker {
            host = "localhost"
            port = 9092
          }
          zk {
            connect = localhost:2181
          }
          serializer.class = "com.precog.common.kafka.KafkaIngestMessageCodec"
        }
      }
    }
  }
  ingest {
      v1 {
        log {
          level = "debug"
          console = true
          filename = "/var/log/precog/dev-ingest-v1.log"
          roll = "daily"
          use_parents = false
        }

        requestLog {
          enabled = false
          file = "/var/log/precog/dev-ingest-v1.request.log"
          roll = "daily"
          fields = "date time c-ip cs-method cs-uri-stem cs-uri-query sc-status cs-content"
          formatter = "w3cs"
          excludePaths = "/blueeyes/services/ingest/v1/health"
        }

        eventStore {
          systemId = "desktop"
          local {
            topic = "local_event_cache"
            broker {
              host = "localhost"
              port = 9082
            }
            serializer.class = "com.precog.common.kafka.KafkaIngestMessageCodec"
          }
          central {
            topic = "central_event_store"
            broker {
              host = "localhost"
              port = 9092
            }
            zk {
              connect = localhost:2181
            }
            serializer.class = "com.precog.common.kafka.KafkaIngestMessageCodec"
          }
        }


        local {
            topic = "local_event_cache"
            broker {
              host = "localhost"
              port = 9082
            }
            serializer.class = "com.precog.common.kafka.KafkaIngestMessageCodec"
          }
          central {
            topic = "central_event_store"
            broker {
              host = "localhost"
              port = 9092
            }
            zk {
              connect = localhost:2181
            }
            serializer.class = "com.precog.common.kafka.KafkaIngestMessageCodec"
          }

        security {
          masterAccount {
            apiKey = "12345678-1234-1234-1234-123456789abc"
            accountId = "desktop"
          }
        }
      }
    }
}
